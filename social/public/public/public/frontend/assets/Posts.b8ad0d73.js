var k=(t,o,y)=>new Promise((f,i)=>{var l=g=>{try{_(y.next(g))}catch(P){i(P)}},D=g=>{try{_(y.throw(g))}catch(P){i(P)}},_=g=>g.done?f(g.value):Promise.resolve(g.value).then(l,D);_((y=y.apply(t,o)).next())});import{_ as q,K as z,O,b as S,P as F,g as L,J as Q,Q as W,R as Y,S as G,M as x,j as p,k as e,m as r,w as a,p as b,N as h,F as A,l as V,t as u,U as H,V as J,n as m,o as c,W as C,X as I,s as K,u as d,q as X,Y as T}from"./vendor.56598cc7.js";const Z={name:"Posts",data(){return{showFilters:!1,currentPage:1,postsPerPage:20,posts:[],connectedProfiles:[],filters:{status:"",profile:"",contentType:"",dateRange:""}}},components:{PlusIcon:z,FunnelIcon:O,DocumentTextIcon:S,PhotoIcon:F,LinkIcon:L,ClockIcon:Q,CheckCircleIcon:W,ArrowTopRightOnSquareIcon:Y,EllipsisVerticalIcon:G},computed:{filteredPosts(){let t=[...this.posts];if(this.filters.status&&(t=t.filter(f=>f.status===this.filters.status)),this.filters.profile&&(t=t.filter(f=>f.social_profile===this.filters.profile)),this.filters.contentType&&(t=t.filter(f=>f.content_type===this.filters.contentType)),this.filters.dateRange){const f=new Date;let i=new Date;switch(this.filters.dateRange){case"today":i.setHours(0,0,0,0);break;case"week":i.setDate(f.getDate()-7);break;case"month":i.setMonth(f.getMonth()-1);break;case"quarter":i.setMonth(f.getMonth()-3);break}t=t.filter(l=>new Date(l.creation)>=i)}const o=(this.currentPage-1)*this.postsPerPage,y=o+this.postsPerPage;return t.slice(o,y)},totalPages(){return Math.ceil(this.posts.length/this.postsPerPage)}},watch:{filters:{handler(){this.currentPage=1,this.loadPosts()},deep:!0}},resources:{connectedProfiles(){return x({url:"frappe.client.get_list",params:{doctype:"Social Profile",fields:["name","profile_name","platform_type"],filters:{is_active:1,platform:"LinkedIn"}},auto:!0,onSuccess:t=>{this.connectedProfiles=t}})},posts(){return x({url:"frappe.client.get_list",auto:!0,onSuccess:t=>{this.posts=t,this.loadAnalytics()}})}},mounted(){this.loadPosts()},methods:{loadPosts(){const t={platform:"LinkedIn"};this.filters.status&&(t.status=this.filters.status),this.filters.profile&&(t.social_profile=this.filters.profile),this.filters.contentType&&(t.content_type=this.filters.contentType),this.$resources.posts.update({params:{doctype:"Content Post",fields:["name","title","content","status","social_profile","scheduled_time","published_at","content_type","creation","linkedin_post_url","linkedin_post_id","failure_reason"],filters:t,order_by:"creation desc",limit:500}}),this.$resources.posts.fetch()},loadAnalytics(){return k(this,null,function*(){for(let t of this.posts)if(t.status==="Published"&&t.linkedin_post_id)try{const o=yield x({url:"frappe.client.get_list"}).submit({doctype:"LinkedIn Analytics",fields:["likes","comments","shares","impressions"],filters:{content_post:t.name},order_by:"creation desc",limit:1});o.length>0&&(t.analytics=o[0])}catch(o){console.error("Error loading analytics:",o)}})},getStatusColor(t){return{Draft:"bg-gray-400",Scheduled:"bg-blue-400",Published:"bg-green-400",Failed:"bg-red-400","Pending Approval":"bg-yellow-400"}[t]||"bg-gray-400"},getContentTypeIcon(t){return{Text:S,Image:F,Link:L}[t]||S},getProfileName(t){const o=this.connectedProfiles.find(y=>y.name===t);return o?o.profile_name:"Unknown Profile"},formatDate(t){return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},formatDateTime(t){return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},viewPost(t){this.$router.push(`/posts/${t.name}`)},editPost(t){this.$router.push(`/posts/${t.name}/edit`)},publishPost(t){return k(this,null,function*(){try{yield x({url:"social.linkedin.publisher.publish_post_now"}).submit({post_id:t.name}),this.loadPosts()}catch(o){console.error("Error publishing post:",o)}})},retryPost(t){return k(this,null,function*(){try{yield x({url:"social.linkedin.publisher.publish_post_now"}).submit({post_id:t.name}),this.loadPosts()}catch(o){console.error("Error retrying post:",o)}})},duplicatePost(t){return k(this,null,function*(){try{const o={doctype:"Content Post",title:`${t.title} (Copy)`,platform:t.platform,social_profile:t.social_profile,content_type:t.content_type,content:t.content,status:"Draft"};yield x({url:"frappe.client.insert"}).submit({doc:o}),this.loadPosts()}catch(o){console.error("Error duplicating post:",o)}})},viewAnalytics(t){this.$router.push(`/posts/${t.name}/analytics`)},cancelSchedule(t){return k(this,null,function*(){try{yield x({url:"social.linkedin.scheduler.cancel_scheduled_post"}).submit({post_id:t.name}),this.loadPosts()}catch(o){console.error("Error cancelling schedule:",o)}})},deletePost(t){return k(this,null,function*(){if(confirm("Are you sure you want to delete this post?"))try{yield x({url:"frappe.client.delete"}).submit({doctype:"Content Post",name:t.name}),this.loadPosts()}catch(o){console.error("Error deleting post:",o)}})},clearFilters(){this.filters={status:"",profile:"",contentType:"",dateRange:""}}}},n=t=>(H("data-v-b1f4f402"),t=t(),J(),t),$={class:"p-6"},ee={class:"flex justify-between items-center mb-6"},te=n(()=>e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900 mb-2"},"Posts"),e("p",{class:"text-gray-600"},"Manage all your LinkedIn content.")],-1)),se={class:"flex space-x-3"},oe=d(" Filters "),ne=d(" Create Post "),ie={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},le=n(()=>e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Status",-1)),re=n(()=>e("option",{value:""},"All Statuses",-1)),ae=n(()=>e("option",{value:"Draft"},"Draft",-1)),ce=n(()=>e("option",{value:"Scheduled"},"Scheduled",-1)),de=n(()=>e("option",{value:"Published"},"Published",-1)),ue=n(()=>e("option",{value:"Failed"},"Failed",-1)),_e=[re,ae,ce,de,ue],he=n(()=>e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Profile",-1)),fe=n(()=>e("option",{value:""},"All Profiles",-1)),me=["value"],pe=n(()=>e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Content Type",-1)),ge=n(()=>e("option",{value:""},"All Types",-1)),ye=n(()=>e("option",{value:"Text"},"Text",-1)),ve=n(()=>e("option",{value:"Image"},"Image",-1)),xe=n(()=>e("option",{value:"Link"},"Link",-1)),be=[ge,ye,ve,xe],ke=n(()=>e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date Range",-1)),Pe=n(()=>e("option",{value:""},"All Time",-1)),we=n(()=>e("option",{value:"today"},"Today",-1)),Ce=n(()=>e("option",{value:"week"},"This Week",-1)),Ie=n(()=>e("option",{value:"month"},"This Month",-1)),De=n(()=>e("option",{value:"quarter"},"This Quarter",-1)),Se=[Pe,we,Ce,Ie,De],Te={class:"flex justify-between items-center mt-4"},Fe=d("Clear Filters"),Le={class:"text-sm text-gray-500"},Ae={class:"space-y-4"},Ve={class:"flex items-start justify-between"},Re={class:"flex-1 min-w-0"},Ee={class:"flex items-center space-x-3 mb-3"},Me={class:"text-sm text-gray-500"},Ne=n(()=>e("span",{class:"text-sm text-gray-500"},"\u2022",-1)),Ue={class:"text-sm text-gray-500"},Be={class:"mb-3"},je={class:"text-lg font-medium text-gray-900 mb-2"},qe={class:"text-gray-600 line-clamp-3"},ze={class:"flex items-center space-x-4 text-sm text-gray-500"},Oe={class:"flex items-center"},Qe={key:0,class:"flex items-center"},We={key:1,class:"flex items-center"},Ye={key:2,class:"flex items-center"},Ge=["href"],He={key:0,class:"mt-3 grid grid-cols-4 gap-4"},Je={class:"text-center"},Ke={class:"text-lg font-semibold text-gray-900"},Xe=n(()=>e("p",{class:"text-xs text-gray-500"},"Likes",-1)),Ze={class:"text-center"},$e={class:"text-lg font-semibold text-gray-900"},et=n(()=>e("p",{class:"text-xs text-gray-500"},"Comments",-1)),tt={class:"text-center"},st={class:"text-lg font-semibold text-gray-900"},ot=n(()=>e("p",{class:"text-xs text-gray-500"},"Shares",-1)),nt={class:"text-center"},it={class:"text-lg font-semibold text-gray-900"},lt=n(()=>e("p",{class:"text-xs text-gray-500"},"Impressions",-1)),rt={class:"flex flex-col space-y-2 ml-4"},at=d(" Publish "),ct=d(" Edit Schedule "),dt=d(" Retry "),ut=d("Edit"),_t=d("Duplicate"),ht=d(" View Analytics "),ft=d(" Cancel Schedule "),mt=d("Delete"),pt={key:0,class:"text-center py-12"},gt=n(()=>e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No posts found",-1)),yt=n(()=>e("p",{class:"text-gray-600 mb-4"},"Get started by creating your first LinkedIn post.",-1)),vt=d(" Create Your First Post "),xt={key:1,class:"text-center py-12"},bt=n(()=>e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"},null,-1)),kt=n(()=>e("p",{class:"text-gray-600 mt-2"},"Loading posts...",-1)),Pt=[bt,kt],wt={key:1,class:"flex justify-center mt-8"},Ct={class:"flex space-x-2"},It=d(" Previous "),Dt={class:"flex items-center px-4 text-sm text-gray-600"},St=d(" Next ");function Tt(t,o,y,f,i,l){const D=m("FunnelIcon"),_=m("Button"),g=m("PlusIcon"),P=m("Card"),R=m("Badge"),E=m("ClockIcon"),M=m("CheckCircleIcon"),N=m("ArrowTopRightOnSquareIcon"),U=m("EllipsisVerticalIcon"),w=m("DropdownItem"),B=m("DropdownMenu"),j=m("DocumentTextIcon");return c(),p("div",$,[e("div",ee,[te,e("div",se,[r(_,{variant:"outline",onClick:o[0]||(o[0]=s=>i.showFilters=!i.showFilters)},{default:a(()=>[r(D,{class:"w-4 h-4 mr-2"}),oe]),_:1}),r(_,{variant:"solid",onClick:o[1]||(o[1]=s=>t.$router.push("/posts/create"))},{default:a(()=>[r(g,{class:"w-4 h-4 mr-2"}),ne]),_:1})])]),i.showFilters?(c(),b(P,{key:0,class:"p-4 mb-6"},{default:a(()=>[e("div",ie,[e("div",null,[le,C(e("select",{"onUpdate:modelValue":o[2]||(o[2]=s=>i.filters.status=s),class:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},_e,512),[[I,i.filters.status]])]),e("div",null,[he,C(e("select",{"onUpdate:modelValue":o[3]||(o[3]=s=>i.filters.profile=s),class:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},[fe,(c(!0),p(A,null,V(i.connectedProfiles,s=>(c(),p("option",{key:s.name,value:s.name},u(s.profile_name),9,me))),128))],512),[[I,i.filters.profile]])]),e("div",null,[pe,C(e("select",{"onUpdate:modelValue":o[4]||(o[4]=s=>i.filters.contentType=s),class:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},be,512),[[I,i.filters.contentType]])]),e("div",null,[ke,C(e("select",{"onUpdate:modelValue":o[5]||(o[5]=s=>i.filters.dateRange=s),class:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},Se,512),[[I,i.filters.dateRange]])])]),e("div",Te,[r(_,{variant:"ghost",onClick:l.clearFilters},{default:a(()=>[Fe]),_:1},8,["onClick"]),e("p",Le,u(i.posts.length)+" posts found",1)])]),_:1})):h("",!0),e("div",Ae,[(c(!0),p(A,null,V(l.filteredPosts,s=>(c(),b(P,{key:s.name,class:"p-6 hover:shadow-md transition-shadow cursor-pointer",onClick:v=>l.viewPost(s)},{default:a(()=>[e("div",Ve,[e("div",Re,[e("div",Ee,[e("div",{class:K(["w-3 h-3 rounded-full",l.getStatusColor(s.status)])},null,2),r(R,{variant:s.status.toLowerCase()},{default:a(()=>[d(u(s.status),1)]),_:2},1032,["variant"]),e("span",Me,u(l.getProfileName(s.social_profile)),1),Ne,e("span",Ue,u(l.formatDate(s.creation)),1)]),e("div",Be,[e("h3",je,u(s.title||"Untitled Post"),1),e("p",qe,u(s.content),1)]),e("div",ze,[e("div",Oe,[(c(),b(X(l.getContentTypeIcon(s.content_type)),{class:"w-4 h-4 mr-1"})),d(" "+u(s.content_type),1)]),s.scheduled_time?(c(),p("div",Qe,[r(E,{class:"w-4 h-4 mr-1"}),d(" Scheduled for "+u(l.formatDateTime(s.scheduled_time)),1)])):h("",!0),s.published_at?(c(),p("div",We,[r(M,{class:"w-4 h-4 mr-1"}),d(" Published "+u(l.formatDateTime(s.published_at)),1)])):h("",!0),s.linkedin_post_url?(c(),p("div",Ye,[r(N,{class:"w-4 h-4 mr-1"}),e("a",{href:s.linkedin_post_url,target:"_blank",class:"text-blue-600 hover:underline"}," View on LinkedIn ",8,Ge)])):h("",!0)]),s.analytics?(c(),p("div",He,[e("div",Je,[e("p",Ke,u(s.analytics.likes||0),1),Xe]),e("div",Ze,[e("p",$e,u(s.analytics.comments||0),1),et]),e("div",tt,[e("p",st,u(s.analytics.shares||0),1),ot]),e("div",nt,[e("p",it,u(s.analytics.impressions||0),1),lt])])):h("",!0)]),e("div",rt,[s.status==="Draft"?(c(),b(_,{key:0,variant:"solid",size:"sm",onClick:T(v=>l.publishPost(s),["stop"])},{default:a(()=>[at]),_:2},1032,["onClick"])):h("",!0),s.status==="Scheduled"?(c(),b(_,{key:1,variant:"outline",size:"sm",onClick:T(v=>l.editPost(s),["stop"])},{default:a(()=>[ct]),_:2},1032,["onClick"])):h("",!0),s.status==="Failed"?(c(),b(_,{key:2,variant:"outline",size:"sm",onClick:T(v=>l.retryPost(s),["stop"])},{default:a(()=>[dt]),_:2},1032,["onClick"])):h("",!0),r(B,null,{trigger:a(()=>[r(_,{variant:"ghost",size:"sm"},{default:a(()=>[r(U,{class:"w-4 h-4"})]),_:1})]),default:a(()=>[r(w,{onClick:v=>l.editPost(s)},{default:a(()=>[ut]),_:2},1032,["onClick"]),r(w,{onClick:v=>l.duplicatePost(s)},{default:a(()=>[_t]),_:2},1032,["onClick"]),s.status==="Published"?(c(),b(w,{key:0,onClick:v=>l.viewAnalytics(s)},{default:a(()=>[ht]),_:2},1032,["onClick"])):h("",!0),s.status==="Scheduled"?(c(),b(w,{key:1,onClick:v=>l.cancelSchedule(s)},{default:a(()=>[ft]),_:2},1032,["onClick"])):h("",!0),r(w,{onClick:v=>l.deletePost(s),class:"text-red-600"},{default:a(()=>[mt]),_:2},1032,["onClick"])]),_:2},1024)])])]),_:2},1032,["onClick"]))),128)),l.filteredPosts.length===0?(c(),p("div",pt,[r(j,{class:"w-12 h-12 text-gray-400 mx-auto mb-4"}),gt,yt,r(_,{variant:"solid",onClick:o[6]||(o[6]=s=>t.$router.push("/posts/create"))},{default:a(()=>[r(g,{class:"w-4 h-4 mr-2"}),vt]),_:1})])):h("",!0),t.$resources.posts.loading?(c(),p("div",xt,Pt)):h("",!0)]),l.filteredPosts.length>0?(c(),p("div",wt,[e("div",Ct,[r(_,{variant:"outline",disabled:i.currentPage===1,onClick:o[7]||(o[7]=s=>i.currentPage--)},{default:a(()=>[It]),_:1},8,["disabled"]),e("span",Dt," Page "+u(i.currentPage)+" of "+u(l.totalPages),1),r(_,{variant:"outline",disabled:i.currentPage===l.totalPages,onClick:o[8]||(o[8]=s=>i.currentPage++)},{default:a(()=>[St]),_:1},8,["disabled"])])])):h("",!0)])}var At=q(Z,[["render",Tt],["__scopeId","data-v-b1f4f402"]]);export{At as default};
