var f=(l,t,u)=>new Promise((P,o)=>{var a=c=>{try{d(u.next(c))}catch(b){o(b)}},k=c=>{try{d(u.throw(c))}catch(b){o(b)}},d=c=>c.done?P(c.value):Promise.resolve(c.value).then(a,k);d((u=u.apply(l,t)).next())});import{_ as T,b as w,P as C,g as I,Z as D,M as y,j as r,m,w as p,k as e,n as v,o as i,W as n,X as F,F as S,l as U,t as _,$ as V,s as N,p as B,q as M,a0 as h,N as x,a1 as E,u as g,Y as q}from"./vendor.56598cc7.js";const O={name:"CreatePost",data(){return{form:{social_profile:"",content_type:"Text",content:"",link_url:"",link_title:"",link_description:"",linkedin_visibility:"PUBLIC",scheduled_date:"",scheduled_time:""},schedulePost:!1,uploadedFile:null,connectedProfiles:[],isSubmitting:!1,contentTypes:[{value:"Text",label:"Text Post",icon:w},{value:"Image",label:"Image Post",icon:C},{value:"Link",label:"Link Post",icon:I}]}},components:{DocumentTextIcon:w,PhotoIcon:C,LinkIcon:I,DocumentIcon:D},computed:{today(){return new Date().toISOString().split("T")[0]}},resources:{connectedProfiles(){return y({url:"frappe.client.get_list",params:{doctype:"Social Profile",fields:["name","profile_name","platform","platform_type","is_active"],filters:{is_active:1,platform:"LinkedIn"}},auto:!0,onSuccess:l=>{this.connectedProfiles=l}})},createPost(){return y({url:"frappe.client.insert",onSuccess:l=>{this.$router.push(`/posts/${l.name}`)},onError:l=>{console.error("Error creating post:",l)}})}},methods:{createPost(){return f(this,null,function*(){this.isSubmitting=!0;try{const l={doctype:"Content Post",title:this.generateTitle(),platform:"LinkedIn",social_profile:this.form.social_profile,content_type:this.form.content_type,content:this.form.content,linkedin_visibility:this.form.linkedin_visibility,status:this.schedulePost?"Scheduled":"Draft"};this.form.content_type==="Link"&&(l.link_url=this.form.link_url,l.link_title=this.form.link_title,l.link_description=this.form.link_description),this.schedulePost&&this.form.scheduled_date&&this.form.scheduled_time&&(l.scheduled_time=`${this.form.scheduled_date} ${this.form.scheduled_time}:00`),yield this.$resources.createPost.submit({doc:l}),this.uploadedFile&&this.form.content_type==="Image"&&(yield this.uploadFile()),this.schedulePost||(yield this.publishPost())}catch(l){console.error("Error creating post:",l)}finally{this.isSubmitting=!1}})},saveDraft(){return f(this,null,function*(){this.schedulePost=!1,yield this.createPost()})},publishPost(){return f(this,null,function*(){try{yield y({url:"social.linkedin.publisher.publish_post_now",params:{post_id:this.postId}}).fetch()}catch(l){console.error("Error publishing post:",l)}})},generateTitle(){const l=this.form.content.trim();return l.length>50?l.substring(0,50)+"...":l||"New Post"},handleFileUpload(l){const t=l.target.files[0];t&&(this.uploadedFile={file:t,name:t.name,url:URL.createObjectURL(t)})},removeFile(){this.uploadedFile=null,this.$refs.fileInput&&(this.$refs.fileInput.value="")},uploadFile(){return f(this,null,function*(){if(!this.uploadedFile)return;const l=new FormData;l.append("file",this.uploadedFile.file),l.append("is_private",0),l.append("folder","Home/Social Media");try{const u=yield(yield fetch("/api/method/upload_file",{method:"POST",body:l})).json();u.message&&(yield this.linkFileToPost(u.message.file_url))}catch(t){console.error("Error uploading file:",t)}})},linkFileToPost(l){return f(this,null,function*(){yield y({url:"frappe.client.insert"}).submit({doc:{doctype:"Content Media",parent:this.postId,parenttype:"Content Post",parentfield:"media_attachments",media_type:"Image",attachment:l}})})}}},R={class:"p-6 max-w-4xl mx-auto"},j=e("div",{class:"mb-6"},[e("h1",{class:"text-2xl font-bold text-gray-900 mb-2"},"Create New Post"),e("p",{class:"text-gray-600"},"Create and schedule content for your LinkedIn profiles.")],-1),W={class:"mb-6"},z=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Select Profile",-1),A=e("option",{value:""},"Choose a LinkedIn profile...",-1),H=["value"],X={class:"mb-6"},Y=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Content Type",-1),Z={class:"grid grid-cols-3 gap-4"},G=["id","value"],J=["for"],K={class:"text-sm font-medium"},Q={class:"mb-6"},$=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Content",-1),ee={class:"text-sm text-gray-500 mt-1"},te={key:0,class:"mb-6"},oe=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Upload Image",-1),se={class:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center"},le={key:0},ie=e("p",{class:"text-sm text-gray-600 mb-2"},"Click to upload an image",-1),re=g(" Choose File "),ne={key:1,class:"space-y-2"},ae=["src","alt"],de={class:"text-sm text-gray-600"},ce=g("Remove"),ue={key:1,class:"mb-6 space-y-4"},me=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Link URL",-1),fe=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Link Title",-1),pe=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Link Description",-1),_e={class:"mb-6"},he=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Visibility",-1),be=e("option",{value:"PUBLIC"},"Public",-1),ge=e("option",{value:"CONNECTIONS"},"Connections Only",-1),ye=[be,ge],ve={class:"mb-6"},ke={class:"flex items-center mb-3"},xe=e("label",{for:"schedule_post",class:"ml-2 text-sm font-medium text-gray-700"}," Schedule for later ",-1),Pe={key:0,class:"grid grid-cols-2 gap-4"},we=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date",-1),Ce=["min"],Ie=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Time",-1),Fe={class:"flex justify-between"},Se=g(" Save as Draft "),Ue={class:"space-x-3"},Le=g(" Cancel ");function Te(l,t,u,P,o,a){const k=v("PhotoIcon"),d=v("Button"),c=v("DocumentIcon"),b=v("Card");return i(),r("div",R,[j,m(b,{class:"p-6"},{default:p(()=>[e("form",{onSubmit:t[13]||(t[13]=q((...s)=>a.createPost&&a.createPost(...s),["prevent"]))},[e("div",W,[z,n(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>o.form.social_profile=s),class:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:""},[A,(i(!0),r(S,null,U(o.connectedProfiles,s=>(i(),r("option",{key:s.name,value:s.name},_(s.profile_name)+" ("+_(s.platform_type)+") ",9,H))),128))],512),[[F,o.form.social_profile]])]),e("div",X,[Y,e("div",Z,[(i(!0),r(S,null,U(o.contentTypes,s=>(i(),r("div",{key:s.value,class:"relative"},[n(e("input",{id:s.value,"onUpdate:modelValue":t[1]||(t[1]=L=>o.form.content_type=L),type:"radio",value:s.value,class:"sr-only"},null,8,G),[[V,o.form.content_type]]),e("label",{for:s.value,class:N(["flex flex-col items-center p-4 border-2 rounded-lg cursor-pointer transition-colors",o.form.content_type===s.value?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"])},[(i(),B(M(s.icon),{class:"w-8 h-8 mb-2 text-gray-600"})),e("span",K,_(s.label),1)],10,J)]))),128))])]),e("div",Q,[$,n(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=s=>o.form.content=s),rows:"6",class:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Write your post content here...",required:""},null,512),[[h,o.form.content]]),e("p",ee,_(o.form.content.length)+"/3000 characters",1)]),o.form.content_type==="Image"?(i(),r("div",te,[oe,e("div",se,[e("input",{ref:"fileInput",type:"file",accept:"image/*",class:"hidden",onChange:t[3]||(t[3]=(...s)=>a.handleFileUpload&&a.handleFileUpload(...s))},null,544),o.uploadedFile?(i(),r("div",ne,[e("img",{src:o.uploadedFile.url,alt:o.uploadedFile.name,class:"max-h-40 mx-auto rounded"},null,8,ae),e("p",de,_(o.uploadedFile.name),1),m(d,{variant:"ghost",onClick:a.removeFile},{default:p(()=>[ce]),_:1},8,["onClick"])])):(i(),r("div",le,[m(k,{class:"w-12 h-12 text-gray-400 mx-auto mb-2"}),ie,m(d,{variant:"outline",onClick:t[4]||(t[4]=s=>l.$refs.fileInput.click())},{default:p(()=>[re]),_:1})]))])])):x("",!0),o.form.content_type==="Link"?(i(),r("div",ue,[e("div",null,[me,n(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>o.form.link_url=s),type:"url",class:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"https://example.com",required:""},null,512),[[h,o.form.link_url]])]),e("div",null,[fe,n(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>o.form.link_title=s),type:"text",class:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Article or page title"},null,512),[[h,o.form.link_title]])]),e("div",null,[pe,n(e("textarea",{"onUpdate:modelValue":t[7]||(t[7]=s=>o.form.link_description=s),rows:"3",class:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Brief description of the link content"},null,512),[[h,o.form.link_description]])])])):x("",!0),e("div",_e,[he,n(e("select",{"onUpdate:modelValue":t[8]||(t[8]=s=>o.form.linkedin_visibility=s),class:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},ye,512),[[F,o.form.linkedin_visibility]])]),e("div",ve,[e("div",ke,[n(e("input",{id:"schedule_post","onUpdate:modelValue":t[9]||(t[9]=s=>o.schedulePost=s),type:"checkbox",class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[E,o.schedulePost]]),xe]),o.schedulePost?(i(),r("div",Pe,[e("div",null,[we,n(e("input",{"onUpdate:modelValue":t[10]||(t[10]=s=>o.form.scheduled_date=s),type:"date",class:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:a.today,required:""},null,8,Ce),[[h,o.form.scheduled_date]])]),e("div",null,[Ie,n(e("input",{"onUpdate:modelValue":t[11]||(t[11]=s=>o.form.scheduled_time=s),type:"time",class:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:""},null,512),[[h,o.form.scheduled_time]])])])):x("",!0)]),e("div",Fe,[m(d,{variant:"ghost",onClick:a.saveDraft},{default:p(()=>[m(c,{class:"w-4 h-4 mr-2"}),Se]),_:1},8,["onClick"]),e("div",Ue,[m(d,{variant:"outline",onClick:t[12]||(t[12]=s=>l.$router.push("/posts"))},{default:p(()=>[Le]),_:1}),m(d,{type:"submit",variant:"solid",loading:o.isSubmitting},{default:p(()=>[g(_(o.schedulePost?"Schedule Post":"Publish Now"),1)]),_:1},8,["loading"])])])],32)]),_:1})])}var Ne=T(O,[["render",Te]]);export{Ne as default};
